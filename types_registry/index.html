<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Properties Visualization</title>
    <!-- d3.js framework -->
    <script type="text/javascript" src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <link rel="stylesheet" href="../stylesheet.css" media="screen" title="no title" charset="utf-8">
</head>
<body>

    <h2>Browse by Type</h2>

    <table>
        <thead>
            <tr>
                <th>Type</th>
                <th>Website</th>
                <th>Properties</th>
            </tr>
        </thead>
        <tbody id="types_table">

        </tbody>
    </table>

    <script type="text/javascript" src="https://code.jquery.com/jquery-2.2.3.min.js"></script>
    <script type="text/javascript" src="../visualizator.js"></script>
    <script type="text/javascript">

        var tableBody = document.getElementById("types_table");
        var event_webs = [];
        var event_props = [];
        var organ_webs = [];
        var organ_props = [];
        var pers_webs = [];
        var pers_props = [];
        var train_webs = [];
        var train_props = [];

        d3.json("../registry.json", function (data) {

            var siti = Object.keys(data);
            for (var i in siti) {
                var selector = data[siti[i]][0];
                for (var j in Object.keys(selector)) {
                    var properts = data[siti[i]][0][Object.keys(selector)[j]];

                    if (Object.keys(selector)[j] == "Event") {
                        event_webs.push(siti[i]);
                        for (var k in properts) {
                            event_props.push(properts[k]);
                        }
                    } else if (Object.keys(selector)[j] == "Organization") {
                        organ_webs.push(siti[i]);
                        for (var k in properts) {
                            organ_props.push(properts[k]);
                        }
                    } else if (Object.keys(selector)[j] == "Person") {
                        pers_webs.push(siti[i]);
                        for (var k in properts) {
                            pers_props.push(properts[k]);
                        }
                    } else if (Object.keys(selector)[j] == "Training") {
                        train_webs.push(siti[i]);
                        for (var k in properts) {
                            train_props.push(properts[k]);
                        }
                    }
                }
            }

            var typeList = ["Event", "Organization", "Person", "Training"];

            for (var i = 0; i < typeList.length; i++) {
                var row = tableBody.insertRow();
                var cell1 = row.insertCell(0);
                var cell2 = row.insertCell(1);
                var cell3 = row.insertCell(2);

                var cellText1 = document.createTextNode(typeList[i]);
                var cellText2,
                        cellText3;
                if (typeList[i] == "Event") {
                    cellText2 = document.createTextNode(event_webs.length);
                    cellText3 = document.createTextNode(event_props.length);
                } else if (typeList[i] == "Organization") {
                    cellText2 = document.createTextNode(organ_webs.length);
                    cellText3 = document.createTextNode(organ_props.length);
                } else if (typeList[i] == "Person") {
                    cellText2 = document.createTextNode(pers_webs.length);
                    cellText3 = document.createTextNode(pers_props.length);
                } else if (typeList[i] == "Training") {
                    cellText2 = document.createTextNode(train_webs.length);
                    cellText3 = document.createTextNode(train_props.length);
                }
                cell1.appendChild(cellText1);
                cell2.appendChild(cellText2);
                cell3.appendChild(cellText3);

            }

        });





        /**
        d3.json("../registry.json", function (data) {

            var siti = Object.keys(data);
            for (var i in siti) {
                var proprieta = [];
                var row = tableBody.insertRow(),
                    cell1 = row.insertCell(0),
                    cell2 = row.insertCell(1),
                    cell3 = row.insertCell(2);
                var primaCella = siti[i];
                var cellText1 = document.createTextNode(primaCella);
                var typeDict = data[primaCella][0];

                var tipi = Object.keys(typeDict);
                var cellText2 = document.createTextNode(tipi);
                for (var j in tipi) {
                    var secondaCella = tipi[j];
                    var toPush = data[primaCella][0][secondaCella];

                    proprieta.push("[" + toPush.toString() + "]");
                }
                proprieta = proprieta.toString();
                var cellText3 = document.createTextNode(proprieta);

                cell1.appendChild(cellText1);
                cell2.appendChild(cellText2);
                cell3.appendChild(cellText3);
            }
        })
        */

    </script>

</body>
</html>
